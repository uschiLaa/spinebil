<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Studying the Behaviour of Projection Pursuit Indices â€¢ spinebil</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="ppi_diagnostics_files/libs/quarto-html/popper.min.js"></script><script src="ppi_diagnostics_files/libs/quarto-html/tippy.umd.min.js"></script><link href="ppi_diagnostics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ppi_diagnostics_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Studying the Behaviour of Projection Pursuit Indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spinebil</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/spinebil.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ppi_diagnostics.html">Studying the Behaviour of Projection Pursuit Indices</a></li>
    <li><a class="dropdown-item" href="../articles/more_descriptives.html">Exploring Potential of Functions to be used for Projection Pursuit</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Studying the Behaviour of Projection Pursuit Indices</h1>





      <div class="d-none name"><code></code></div>
    </div>






    <blockquote>
<p>A practical tour of the five most important functions in <strong>spinebil</strong> for finding, validating, and understanding projection pursuit indices.</p>
</blockquote>
<section class="level2"><h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In this vignette we introduce three example datasets; <em>spiral</em>, a <em>sine</em>, and a <em>pipe</em> dataset and then evaluate five key characteristics of projection pursuit indices (PPIs): smoothness, squintability, flexibility, rotation invariance and speed.</p>
<p>We will generate the datasets first, then walk through one section per characteristic with the functions provided in spinebil.</p>
</section><section class="level2"><h2 id="data-generators">Data Generators<a class="anchor" aria-label="anchor" href="#data-generators"></a>
</h2>
<ul>
<li>
<strong><code>pipe_data(n, p, t)</code></strong>; a pipe (circular ring) structure.</li>
<li>
<strong><code>sin_data(n, p, f)</code></strong>; a sine relationship.</li>
<li>
<strong><code>spiral_data(n, p)</code></strong>; an archimedean spiral.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Pipe   <span class="op">=</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/pipe_data.html">pipe_data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>  Sine   <span class="op">=</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/sin_data.html">sin_data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  Spiral <span class="op">=</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/spiral_data.html">spiral_data</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lst</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lbl</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">lst</span><span class="op">[[</span><span class="va">lbl</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d</span><span class="op">[[</span><span class="va">p</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">d</span><span class="op">[[</span><span class="va">p</span><span class="op">]</span><span class="op">]</span>, structure <span class="op">=</span> <span class="va">lbl</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_all</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span>, size <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">structure</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    aspect.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    axis.text  <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="ppi_diagnostics_files/figure-html/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Now we employ these patterns to evaluate key characteristics of PPIs.</p>
</section><section class="level2"><h2 id="compare_smoothing">1) <code>compare_smoothing()</code>
<a class="anchor" aria-label="anchor" href="#compare_smoothing"></a>
</h2>
<p>Projection pursuit indices evaluated along a tour path can be spiky due to small numerical changes in the projection or to point-level noise. <code><a href="../reference/compare_smoothing.html">compare_smoothing()</a></code> provides a principled way to smooth these traces by averaging the index over local perturbations, and to compare different smoothing strategies side-by-side.</p>
<p>It supports two kinds of perturbations:</p>
<ul>
<li>
<code>jitter_angle</code>: randomly jitter the projection plane by a small angle <code>alpha</code> via geodesic moves, then recompute the index.</li>
<li>
<code>jitter_points</code>: randomly jitter the projected points by a small amount (using <code><a href="https://rdrr.io/r/base/jitter.html" class="external-link">base::jitter()</a></code>), then recompute the index.</li>
<li>
<code>no_smoothing</code>: the original index with no perturbation.</li>
</ul>
<p>Averaging across multiple perturbations reduces high-frequency noise and reveals the underlying trend of the index along the tour.</p>
<section class="level3"><h3 id="function-usage">Function Usage<a class="anchor" aria-label="anchor" href="#function-usage"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_smoothing</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  d,         <span class="co"># data matrix (n x p)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  tPath,     <span class="co"># interpolated tour path: list of projection bases (p x 2)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  idx,       <span class="co"># index function</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alphaV =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>),  jitter amounts to <span class="fu">compare</span> (<span class="cf">for</span> jittering angle or points)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">10</span>     <span class="co"># number of evaluations entering mean value calculation</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section><section class="level3"><h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<ul>
<li>
<code>d</code>, numeric data matrix with <code>p</code> columns. It will be projected as <code>d %*% basis</code> for each basis in <code>tPath</code>.</li>
<li>
<code>tPath</code>, list of (p Ã— 2) projection bases. Typically built from a tour history using <code><a href="https://ggobi.github.io/tourr/reference/save_history.html" class="external-link">tourr::save_history()</a></code> and <code><a href="https://ggobi.github.io/tourr/reference/interpolate.html" class="external-link">tourr::interpolate()</a></code>.</li>
<li>
<code>idx</code>, index function accepting a two-column matrix and returning a single numeric value (e.g., <code>scag_index("stringy")</code>).</li>
<li>
<code>alphaV</code>, numeric vector of jitter magnitudes to compare.</li>
<li>
<code>n</code>, number of evaluations entering mean value calculation (larger <code>n</code> â†’ smoother, slower).</li>
</ul></section><section class="level3"><h3 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/spiral_data.html">spiral_data</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tPath</span> <span class="op">&lt;-</span> <span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/save_history.html" class="external-link">save_history</a></span><span class="op">(</span><span class="va">d</span>, max_bases<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">tPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/interpolate.html" class="external-link">interpolate</a></span><span class="op">(</span><span class="va">tPath</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span></span>
<span><span class="va">compS</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/compare_smoothing.html">compare_smoothing</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">tPath</span>, <span class="va">idx</span>, alphaV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_smoothing_comparison.html">plot_smoothing_comparison</a></span><span class="op">(</span><span class="va">compS</span>, lPos <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="ppi_diagnostics_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h3 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h3>
<ul>
<li>
<strong>no_smoothing (red, solid)</strong>: the raw index trace along the tour. Spiky traces indicate high sensitivity to tiny projection changes.</li>
<li>
<strong>jitter_angle (black, dashed)</strong>: averaging over nearby projection angles. Smooths out highâ€‘frequency variability caused by small plane movements; preserves structure amplitude better when index is robust to minor orientation shifts.</li>
<li>
<strong>jitter_points (black, dotted)</strong>: averaging over point noise. Strong smoothing when the index is sensitive to local point perturbations.</li>
</ul></section><section class="level3"><h3 id="return-value">Return value<a class="anchor" aria-label="anchor" href="#return-value"></a>
</h3>
<p>A tibble with columns:</p>
<ul>
<li>
<code>index_mean</code>, mean index value at each frame (includes the original, unjittered value).</li>
<li>
<code>t</code>, integer frame index along the tour path.</li>
<li>
<code>method</code>, one of <code>"jitter_angle"</code>, <code>"jitter_points"</code>, <code>"no_smoothing"</code>.</li>
<li>
<code>alpha</code>, jitter magnitude used for that row.</li>
</ul></section></section><section class="level2"><h2 id="squint_angle_estimate">2) <code>squint_angle_estimate()</code>
<a class="anchor" aria-label="anchor" href="#squint_angle_estimate"></a>
</h2>
<p><em>From how far away (in projection space) does the pattern become visible under a chosen index?</em></p>
<p><code><a href="../reference/squint_angle_estimate.html">squint_angle_estimate()</a></code>, produces a distribution of squint angles by repeatedly walking from random 2â€‘D planes toward an assumed optimal plane (the best view of a structure) and recording the first point along each path where a userâ€‘chosen index function exceeds a visibility cutoff.</p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Larger squint angles â‡’ easier to see</strong> (the index crosses the cutoff while still far from the optimal plane).</li>
<li>
<strong>Smaller squint angles â‡’ harder to see</strong> (the index only crosses when we are very close to the optimal plane).</li>
</ul></section><section class="level2"><h2 id="function-usage-1">Function usage<a class="anchor" aria-label="anchor" href="#function-usage-1"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/squint_angle_estimate.html">squint_angle_estimate</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,            <span class="co"># numeric matrix/data frame (n x p)</span></span>
<span>  <span class="va">indexF</span>,          <span class="co"># function: (n x 2) -&gt; numeric scalar</span></span>
<span>  <span class="va">cutoff</span>,          <span class="co"># numeric threshold for 'visible'</span></span>
<span>  <span class="va">structure_plane</span>,  <span class="co"># 2-D basis (p x 2) representing the optimal view</span></span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,         <span class="co"># number of random starts</span></span>
<span>  step_size <span class="op">=</span> <span class="fl">0.01</span>  <span class="co"># interpolation step along the tour path</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="level2"><h2 id="example-usage-1">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage-1"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/spiral_data.html">spiral_data</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">indexF</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">structure_plane</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/basis_matrix.html">basis_matrix</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/squint_angle_estimate.html">squint_angle_estimate</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">indexF</span>, <span class="va">cutoff</span>, <span class="va">structure_plane</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1.2608853 0.8575882 1.5517116 1.2912668 1.6689615 1.4934251 1.3363701</span></span>
<span><span class="co">#&gt;  [8] 1.7699582 1.9304979 1.3067327</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="inputs-1">Inputs<a class="anchor" aria-label="anchor" href="#inputs-1"></a>
</h2>
<section class="level3"><h3 id="indexf-what-kind-of-structure">
<code>indexF</code> (what kind of structure?)<a class="anchor" aria-label="anchor" href="#indexf-what-kind-of-structure"></a>
</h3>
<p>Choose an index that matches the pattern you care about. With scagnostics-style indices, for example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indexF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span>   <span class="co"># sine-wave/spiral-like</span></span>
<span><span class="va">indexF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"skinny"</span><span class="op">)</span>  <span class="co"># elongated patterns</span></span></code></pre></div>
</section><section class="level3"><h3 id="cutoff-when-do-we-call-it-visible">
<code>cutoff</code> (when do we call it visible?)<a class="anchor" aria-label="anchor" href="#cutoff-when-do-we-call-it-visible"></a>
</h3>
<p>Set this dataâ€‘driven so results are comparable across datasets and indices.</p>
<ul>
<li>Preferred: 95thâ€“99th percentile of the index computed on random projections (a null where no specific structure is targeted).</li>
<li>You can use <code>index_noise_threshold()</code> to estimate this cutoff automatically.</li>
</ul></section><section class="level3"><h3 id="structure_plane-where-is-the-best-view">
<code>structure_plane</code> (where is the best view?)<a class="anchor" aria-label="anchor" href="#structure_plane-where-is-the-best-view"></a>
</h3>
<p>If you know the two variables that define the structure, construct the basis directly. Otherwise, run a guided tour to maximize the index and use the best basis it returns.</p>
</section><section class="level3"><h3 id="n-and-step_size">
<code>n</code> and <code>step_size</code>
<a class="anchor" aria-label="anchor" href="#n-and-step_size"></a>
</h3>
<ul>
<li>
<code>n = 100</code> typically yields a stable distribution for summaries and plots.</li>
<li>
<code>step_size = 0.01</code> is a good accuracy/speed tradeâ€‘off. If the threshold crossing looks coarse (the index jumps over the cutoff), try <code>0.005</code>. If runtime is an issue, use something larger (e.g., <code>0.02</code>).</li>
</ul></section></section><section class="level2"><h2 id="return-value-1">Return value<a class="anchor" aria-label="anchor" href="#return-value-1"></a>
</h2>
<ul>
<li>
<strong><code><a href="../reference/squint_angle_estimate.html">squint_angle_estimate()</a></code></strong> returns a numeric vector of length <code>n</code> containing the squint-angle estimates under the specified index and cutoff.</li>
</ul></section><section class="level2"><h2 id="get_trace">3) <code>get_trace()</code>
<a class="anchor" aria-label="anchor" href="#get_trace"></a>
</h2>
<p><code><a href="../reference/get_trace.html">get_trace()</a></code> evaluates one or more projection pursuit indices along an interpolated, planned tour path and returns their values at each frame. Plotting these traces reveals whether an index varies smoothly with small changes in the projection (desirable), or exhibits spikes (potentially unstable, overly sensitive, or underâ€‘smoothed).</p>
<p>A smooth trace indicates that small rotations of the view produce small changes in the index,an important property for guided tours and optimisation.</p>
<p>In combination with <code><a href="../reference/plot_trace.html">plot_trace()</a></code>, you can quickly diagnose index behaviour across a path connecting userâ€‘specified views.</p>
</section><section class="level2"><h2 id="function-usage-2">Function Usage<a class="anchor" aria-label="anchor" href="#function-usage-2"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_trace.html">get_trace</a></span><span class="op">(</span></span>
<span>  <span class="va">d</span>,           <span class="co"># data: matrix/data frame (n x p)</span></span>
<span>  <span class="va">m</span>,           <span class="co"># list of projection matrices for the planned tour</span></span>
<span>  <span class="va">index_list</span>,   <span class="co"># list of index functions to calculate for each entry -&gt; numeric</span></span>
<span>  <span class="va">index_labels</span>  <span class="co"># character vector of labels for the indices</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="level2"><h2 id="inputs-2">Inputs<a class="anchor" aria-label="anchor" href="#inputs-2"></a>
</h2>
<ul>
<li>
<code>d</code>; numeric data with <code>p</code> columns.</li>
<li>
<code>m</code>; list of (p Ã— 2) projection matrices for the planned tour.</li>
<li>
<code>index_list</code>; list of functions that take a twoâ€‘column matrix and return a numeric scalar (e.g., <code><a href="https://ggobi.github.io/tourr/reference/holes.html" class="external-link">tourr::holes()</a></code>, <code><a href="https://ggobi.github.io/tourr/reference/cmass.html" class="external-link">tourr::cmass()</a></code>, or <code>scag_index("stringy")</code>).</li>
<li>
<code>index_labels</code>; character vector of the same length and order as <code>index_list</code>; used as column names in the output.</li>
</ul></section><section class="level2"><h2 id="example-usage-2">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage-2"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/spiral_data.html">spiral_data</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/basis_matrix.html">basis_matrix</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/basis_matrix.html">basis_matrix</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/holes.html" class="external-link">holes</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/norm_bin.html" class="external-link">norm_kol</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"holes"</span>, <span class="st">"norm kol"</span><span class="op">)</span></span>
<span><span class="va">trace</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/get_trace.html">get_trace</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span>, <span class="va">index_list</span>, <span class="va">index_labels</span><span class="op">)</span></span>
<span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_trace.html">plot_trace</a></span><span class="op">(</span><span class="va">trace</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="ppi_diagnostics_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_trace.html">plot_trace</a></span><span class="op">(</span><span class="va">trace</span>, rescY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="ppi_diagnostics_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="return-value-2">Return value<a class="anchor" aria-label="anchor" href="#return-value-2"></a>
</h2>
<p>A numeric matrix with <code>length(index_labels) + 1</code> columns and as many rows as interpolation frames. Columns are the index values (named by <code>index_labels</code>) and <code>t</code> (the frame index).</p>
</section><section class="level2"><h2 id="profile_rotation">4) <code>profile_rotation()</code>
<a class="anchor" aria-label="anchor" href="#profile_rotation"></a>
</h2>
<p><em>Does the index value stay the same when the 2â€‘D data are rotated?</em></p>
<p><code><a href="../reference/profile_rotation.html">profile_rotation()</a></code> tests rotation invariance of one or more 2-D projection indices.</p>
<p><strong>Interpretation</strong></p>
<ul>
<li>
<strong>Flat profile</strong> â†’ rotation invariant.</li>
<li>
<strong>Oscillating profile</strong> â†’ orientation dependence.</li>
</ul>
<section class="level3"><h3 id="function-usage-3">Function Usage<a class="anchor" aria-label="anchor" href="#function-usage-3"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/profile_rotation.html">profile_rotation</a></span><span class="op">(</span></span>
<span>  <span class="va">d</span>,            <span class="co"># 2-column numeric matrix (the data to rotate)</span></span>
<span>  <span class="va">index_list</span>,    <span class="co"># list of functions: (n x 2) -&gt; numeric</span></span>
<span>  <span class="va">index_labels</span>,  <span class="co"># character labels for columns</span></span>
<span>  n <span class="op">=</span> <span class="fl">200</span>       <span class="co"># number of rotation steps across [0, 2*pi]</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="level3"><h3 id="inputs-3">Inputs<a class="anchor" aria-label="anchor" href="#inputs-3"></a>
</h3>
<ul>
<li>
<code>d</code>: numeric matrix with 2 columns; the 2-D data to be rotated.</li>
<li>
<code>index_list</code>: list of functions, each taking an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>Ã—</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n \times 2)</annotation></semantics></math> numeric matrix and returning a single numeric index value. Examples: <code>list(tourr::holes(), scag_index("stringy"), mine_indexE("MIC"))</code>.</li>
<li>
<code>index_labels</code>: character vector of labels (one per index in <code>index_list</code>) used as column names in the result.</li>
<li>
<code>n</code> <em>(default = 200)</em>: integer number of rotation steps.</li>
</ul></section><section class="level3"><h3 id="example-usage-3">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage-3"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/sin_data.html">sin_data</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/holes.html" class="external-link">holes</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span>, <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/scag_index.html">mine_indexE</a></span><span class="op">(</span><span class="st">"MIC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"holes"</span>, <span class="st">"stringy"</span>, <span class="st">"mic"</span><span class="op">)</span></span>
<span><span class="va">pRot</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/profile_rotation.html">profile_rotation</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">index_list</span>, <span class="va">index_labels</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_rotation.html">plot_rotation</a></span><span class="op">(</span><span class="va">pRot</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="ppi_diagnostics_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h3 id="interpretation-1">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation-1"></a>
</h3>
<ul>
<li>Perfect circle (constant radius) â†’ <em>rotation invariant</em>.</li>
<li>Deformed/flower-like shape â†’ <em>orientation dependence</em>.</li>
</ul></section><section class="level3"><h3 id="return-value-3">Return value<a class="anchor" aria-label="anchor" href="#return-value-3"></a>
</h3>
<p>A numeric matrix with <code>n + 1</code> rows and <code>length(index_labels) + 1</code> columns:</p>
<ul>
<li>One column per index (named by <code>index_labels</code>) containing the index values at each angle.</li>
<li>An additional column <code>alpha</code> giving the corresponding angles in radians.</li>
</ul></section></section><section class="level2"><h2 id="time_sequence">5) <code>time_sequence()</code>
<a class="anchor" aria-label="anchor" href="#time_sequence"></a>
</h2>
<p>The cost of evaluating a projection pursuit index can vary with both the data distribution and the projection. <code><a href="../reference/time_sequence.html">time_sequence()</a></code> times the index on a sequence of projection bases and returns a simple table you can plot or summarise.</p>
<section class="level3"><h3 id="function-usage-4">Function Usage<a class="anchor" aria-label="anchor" href="#function-usage-4"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/time_sequence.html">time_sequence</a></span><span class="op">(</span></span>
<span>  <span class="va">d</span>,      <span class="co"># numeric data matrix (n x p)</span></span>
<span>  <span class="va">t</span>,      <span class="co"># list of projection matrices (each p x 2); e.g., an interpolated tour path</span></span>
<span>  <span class="va">idx</span>,    <span class="co"># index function: (n x 2) -&gt; numeric</span></span>
<span>  <span class="va">pmax</span>    <span class="co"># maximum number of projections to evaluate (cut t if longer than pmax)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="level3"><h3 id="inputs-4">Inputs<a class="anchor" aria-label="anchor" href="#inputs-4"></a>
</h3>
<ul>
<li>
<code>d</code>: numeric matrix of size <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>.</li>
<li>
<code>t</code>: list of (p Ã— 2) projection bases (e.g., from <code><a href="https://ggobi.github.io/tourr/reference/basis_random.html" class="external-link">tourr::basis_random()</a></code> or an interpolated tour history).</li>
<li>
<code>idx</code>: index function mapping a two-column matrix to a single numeric value (e.g., <code>scag_index("stringy")</code>).</li>
<li>
<code>pmax</code>: integer limit; evaluation stops after <code>pmax</code> projections even if <code>t</code> is longer.</li>
</ul></section><section class="level3"><h3 id="example-usage-4">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage-4"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/spiral_data.html">spiral_data</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">~</span> <span class="fu">tourr</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/tourr/reference/basis_random.html" class="external-link">basis_random</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/scag_index.html">scag_index</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span></span>
<span><span class="fu">spinebil</span><span class="fu">::</span><span class="fu"><a href="../reference/time_sequence.html">time_sequence</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">t</span>, <span class="va">idx</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        t  i</span></span>
<span><span class="co">#&gt; 1  0.036  1</span></span>
<span><span class="co">#&gt; 2  0.039  2</span></span>
<span><span class="co">#&gt; 3  0.036  3</span></span>
<span><span class="co">#&gt; 4  0.038  4</span></span>
<span><span class="co">#&gt; 5  0.038  5</span></span>
<span><span class="co">#&gt; 6  0.034  6</span></span>
<span><span class="co">#&gt; 7  0.037  7</span></span>
<span><span class="co">#&gt; 8  0.039  8</span></span>
<span><span class="co">#&gt; 9  0.038  9</span></span>
<span><span class="co">#&gt; 10 0.038 10</span></span></code></pre></div>
</div>
</section><section class="level3"><h3 id="return-value-4">Return value<a class="anchor" aria-label="anchor" href="#return-value-4"></a>
</h3>
<p>A data frame with two columns:</p>
<ul>
<li>
<code>t</code>: elapsed time in seconds for the index evaluation at that projection.</li>
<li>
<code>i</code>: the sequence index (1, 2, â€¦) of the projection in <code>t</code>.</li>
</ul></section></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ursula Laa, Dianne Cook, Tina Rashid Jafari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
