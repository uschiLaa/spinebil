<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample-Size Effects for Projection Pursuit Indexes under Gaussian Noise • spinebil</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="sampleSizeEffect_files/libs/quarto-html/popper.min.js"></script><script src="sampleSizeEffect_files/libs/quarto-html/tippy.umd.min.js"></script><link href="sampleSizeEffect_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sampleSizeEffect_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample-Size Effects for Projection Pursuit Indexes under Gaussian Noise">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spinebil</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/spinebil.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/indexMean.html">Simulate and Summarize Projection Pursuit Index (PPI) Means</a></li>
    <li><a class="dropdown-item" href="../articles/indexNoiseThreshold.html">Estimating a Noise Threshold for Projection–Pursuit Indices</a></li>
    <li><a class="dropdown-item" href="../articles/indexScale.html">Comparing Index Scale on Structured vs. Noisy Data</a></li>
    <li><a class="dropdown-item" href="../articles/ppiDiagnostics.html">spinebil: Core Diagnostics for Projection Pursuit Indices</a></li>
    <li><a class="dropdown-item" href="../articles/sampleSizeEffect.html">Sample-Size Effects for Projection Pursuit Indexes under Gaussian Noise</a></li>
    <li><a class="dropdown-item" href="../articles/utilsData.html">Generating Synthetic Structures and Noise</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample-Size Effects for Projection Pursuit Indexes under Gaussian Noise</h1>

      <p class="author">Tina Rashid Jafari</p>



      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This demonstrates how to use the <code><a href="../reference/ppi_samplesize_effect.html">ppi_samplesize_effect()</a></code> function to study how projection pursuit index (PPI) values behave under increasing sample sizes in purely noisy (Gaussian) data. Understanding how an index behaves under null conditions is critical for:</p>
<ul>
<li>Calibrating thresholds for statistical significance</li>
<li>Identifying sensitivity to sample size</li>
<li>Comparing robustness across different index functions</li>
</ul></section><section class="level2"><h2 id="what-the-function-does">What the Function Does<a class="anchor" aria-label="anchor" href="#what-the-function-does"></a>
</h2>
<p>The function <code><a href="../reference/ppi_samplesize_effect.html">ppi_samplesize_effect()</a></code> runs repeated simulations of standard normal noise across a range of sample sizes. For each size, it computes a specified index function over the samples and records the 95th percentile of index values observed. This helps estimate the distributional behavior of the index under pure noise, depending on sample size. These curves are useful as a null reference: above-curve values may indicate non-random structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spinebil</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/numbats/cassowaryr" class="external-link">cassowaryr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="function-usage">Function usage<a class="anchor" aria-label="anchor" href="#function-usage"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ppi_samplesize_effect.html">ppi_samplesize_effect</a></span><span class="op">(</span><span class="va">index_fun</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>index_fun</code>: a function that accepts the data for one simulation and returns a single numeric index value.</li>
<li>
<code>n_sim</code>: the number of simulations per sample size (default 100).</li>
</ul>
<blockquote>
<p>Internally, the function evaluates a grid of sample sizes from 30 up to 2000 (denser at small sizes), simulates <code>n_sim</code> draws for each, and returns the 95th percentile of the resulting index values.</p>
</blockquote>
</section><section class="level2"><h2 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<p>Let’s evaluate the <code>stringy</code> index from the <code>cassowaryr</code> package to see how its values change under noise as the sample size increases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppi_samplesize_effect.html">ppi_samplesize_effect</a></span><span class="op">(</span><span class="fu"><a href="../reference/scagIndex.html">scagIndex</a></span><span class="op">(</span><span class="st">"stringy"</span><span class="op">)</span>, n_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span><span class="co">#&gt;   SampleSize Percentile95</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1         30        0.762</span></span>
<span><span class="co">#&gt; 2         35        0.768</span></span>
<span><span class="co">#&gt; 3         40        0.788</span></span>
<span><span class="co">#&gt; 4         45        0.793</span></span>
<span><span class="co">#&gt; 5         50        0.755</span></span>
<span><span class="co">#&gt; 6         55        0.802</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span><span class="co">#&gt;   SampleSize Percentile95</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       1875        0.744</span></span>
<span><span class="co">#&gt; 2       1900        0.742</span></span>
<span><span class="co">#&gt; 3       1925        0.740</span></span>
<span><span class="co">#&gt; 4       1950        0.734</span></span>
<span><span class="co">#&gt; 5       1975        0.735</span></span>
<span><span class="co">#&gt; 6       2000        0.744</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="plot-the-95th-percentile">Plot the 95th-percentile<a class="anchor" aria-label="anchor" href="#plot-the-95th-percentile"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">SampleSize</span>, <span class="va">Percentile95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, span <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Sample size (n)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"95th percentile of index"</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="sampleSizeEffect_files/figure-html/unnamed-chunk-3-1.png" width="720"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="return-value">Return value<a class="anchor" aria-label="anchor" href="#return-value"></a>
</h2>
<p><code><a href="../reference/ppi_samplesize_effect.html">ppi_samplesize_effect()</a></code> returns a tibble:</p>
<ul>
<li>
<code>SampleSize</code>: the sample size for that block of simulations</li>
<li>
<code>Percentile95</code>: the empirical 95th percentile of the index across the <code>n_sim</code> simulations at that size.</li>
</ul></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ursula Laa, Dianne Cook, Tina Rashid Jafari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
